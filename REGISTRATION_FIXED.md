# ‚úÖ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ê

## üéâ –°–¢–ê–¢–£–°: –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 27 –Ω–æ—è–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

---

## üîç –ß–¢–û –ë–´–õ–û –ù–ê–ô–î–ï–ù–û

**–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —Ç—Ä–∏–≥–≥–µ—Ä `on_auth_user_created` –≤ Supabase

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã (`profiles` vs `user_profiles`)

---

## üõ†Ô∏è –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### 1. ‚úÖ –°–æ–∑–¥–∞–Ω —Ç—Ä–∏–≥–≥–µ—Ä –≤ Supabase

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `profiles`:**

```sql
CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (id, email, subscription_tier)
  VALUES (NEW.id, NEW.email, 'free')
  ON CONFLICT (id) DO NOTHING;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;
CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ `profiles` (–Ω–µ `user_profiles`). –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.

### 3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- Environment variables –Ω–∞ Vercel
- RLS policies –≤ Supabase
- –ö–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—ë–Ω

---

## üöÄ –†–ï–ó–£–õ–¨–¢–ê–¢

- ‚úÖ **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞**
- ‚úÖ **10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É–∂–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ**
- ‚úÖ **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**

---

## üìã –ü–†–û–í–ï–†–ö–ê

### –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:**
   ```
   https://chatedem.com/signup
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç—Å—è:**
   ```sql
   -- –í Supabase SQL Editor:
   SELECT * FROM auth.users ORDER BY created_at DESC LIMIT 5;
   SELECT * FROM profiles ORDER BY created_at DESC LIMIT 5;
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:**
   ```
   Vercel Dashboard ‚Üí Logs ‚Üí –∏—â–∏ [REGISTER]
   –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   ```

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï

**–¢–∞–±–ª–∏—Ü–∞ –≤ –∫–æ–¥–µ:** `profiles` (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ 18 –º–µ—Å—Ç–∞—Ö)  
**–¢—Ä–∏–≥–≥–µ—Ä –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** `profiles`  
**–ö–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:** `profiles` ‚úÖ

**–í—Å—ë —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ!** –¢—Ä–∏–≥–≥–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `profiles`.

---

## ‚úÖ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –ø–æ–ª–Ω—ã–π flow:**
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –í—Ö–æ–¥ ‚Üí –ß–∞—Ç ‚Üí –û–ø–ª–∞—Ç–∞

2. **–ú–æ–Ω–∏—Ç–æ—Ä—å –º–µ—Ç—Ä–∏–∫–∏:**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –≤ –¥–µ–Ω—å
   - –£—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
   - –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

3. **–°–æ–±–µ—Ä–∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å:**
   - –£–¥–æ–±–Ω–æ –ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è?
   - –ü–æ–Ω—è—Ç–Ω—ã –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö?

---

## üéØ –°–¢–ê–¢–£–°

**‚úÖ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–ê–ï–¢**

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

**–î–∞—Ç–∞:** 27 –Ω–æ—è–±—Ä—è 2024  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –¢—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

