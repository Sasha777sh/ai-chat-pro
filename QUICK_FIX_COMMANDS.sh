#!/bin/bash

# üö® –ë–´–°–¢–†–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò EDEM
# –ó–∞–ø—É—Å—Ç–∏ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

echo "üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò EDEM"
echo "================================"
echo ""

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
if [ -f .env.local ]; then
    echo "‚úÖ –§–∞–π–ª .env.local –Ω–∞–π–¥–µ–Ω"
    echo "–ü—Ä–æ–≤–µ—Ä—è—é –∫–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:"
    grep -E "SUPABASE|OPENAI" .env.local | sed 's/=.*/=***HIDDEN***/'
else
    echo "‚ö†Ô∏è –§–∞–π–ª .env.local –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "–°–æ–∑–¥–∞–π –µ–≥–æ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–∑ Vercel"
fi
echo ""

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
echo "2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏..."
if [ -f src/app/api/auth/register/route.ts ]; then
    echo "‚úÖ –§–∞–π–ª —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω"
    echo "–ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞–ª–∏—á–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫..."
    if grep -q "catch\|error" src/app/api/auth/register/route.ts; then
        echo "‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –µ—Å—Ç—å"
    else
        echo "‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
    fi
else
    echo "‚ùå –§–∞–π–ª —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω!"
fi
echo ""

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ Supabase –∫–ª–∏–µ–Ω—Ç–∞
echo "3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ Supabase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
if [ -f src/lib/supabase.ts ]; then
    echo "‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω"
else
    echo "‚ö†Ô∏è Supabase –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi
echo ""

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
echo "4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞..."
if npm run build 2>&1 | grep -q "error\|Error"; then
    echo "‚ùå –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ!"
    npm run build 2>&1 | grep -i error | head -5
else
    echo "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞"
fi
echo ""

# 5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
echo "üìã –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:"
echo "1. –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel"
echo "2. –£–±–µ–¥–∏—Å—å, —á—Ç–æ NEXT_PUBLIC_SUPABASE_ANON_KEY = anon key (–ù–ï service role!)"
echo "3. –ü—Ä–æ–≤–µ—Ä—å —Ç—Ä–∏–≥–≥–µ—Ä –≤ Supabase (SQL Editor)"
echo "4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ª–æ–∫–∞–ª—å–Ω–æ: npm run dev"
echo "5. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Vercel –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è"
echo ""

echo "‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

